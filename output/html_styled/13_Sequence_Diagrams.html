<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>13 Sequence Diagrams</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="../styles/beautiful.css" />

        <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@400;600&display=swap');

        :root {
            --primary: #2563eb;
            --secondary: #7c3aed;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1e293b;
            --light: #f8fafc;
            --gray: #64748b;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        #TOC {
            background: var(--dark);
            color: white;
            padding: 30px;
            position: sticky;
            top: 0;
            max-height: 100vh;
            overflow-y: auto;
        }

        #TOC ul {
            list-style: none;
        }

        #TOC a {
            color: #94a3b8;
            text-decoration: none;
            display: block;
            padding: 8px 12px;
            border-radius: 6px;
            transition: all 0.3s;
        }

        #TOC a:hover {
            background: rgba(255,255,255,0.1);
            color: white;
            transform: translateX(5px);
        }

        main {
            padding: 60px;
        }

        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            margin: 1.5em 0 0.5em;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        h1 {
            font-size: 3em;
            margin-top: 0;
            padding-bottom: 20px;
            border-bottom: 4px solid var(--primary);
        }

        h2 {
            font-size: 2.2em;
            margin-top: 1.5em;
            padding-left: 20px;
            border-left: 5px solid var(--primary);
        }

        h3 {
            font-size: 1.6em;
        }

        p {
            margin: 1em 0;
            font-size: 1.05em;
        }

        code {
            font-family: 'JetBrains Mono', monospace;
            background: #f1f5f9;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.9em;
            color: var(--secondary);
        }

        pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 25px;
            border-radius: 12px;
            overflow-x: auto;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        pre code {
            background: transparent;
            color: inherit;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        th {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e2e8f0;
        }

        tr:hover {
            background: #f8fafc;
        }

        blockquote {
            border-left: 5px solid var(--primary);
            background: #f8fafc;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
            font-style: italic;
        }

        a {
            color: var(--primary);
            text-decoration: none;
            border-bottom: 2px solid transparent;
            transition: border-color 0.3s;
        }

        a:hover {
            border-bottom-color: var(--primary);
        }

        ul, ol {
            margin: 1em 0;
            padding-left: 30px;
        }

        li {
            margin: 0.5em 0;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            main {
                padding: 30px 20px;
            }

            h1 {
                font-size: 2em;
            }

            h2 {
                font-size: 1.6em;
            }
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
            }

            #TOC {
                display: none;
            }
        }
        </style>
        </head>
<body><div class="container">
<header id="title-block-header">
<h1 class="title">13 Sequence Diagrams</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#sequence-diagrams---vision-based-pick-and-place-system"
id="toc-sequence-diagrams---vision-based-pick-and-place-system"><span
class="toc-section-number">1</span> Sequence Diagrams - Vision-Based
Pick and Place System</a>
<ul>
<li><a href="#document-control" id="toc-document-control"><span
class="toc-section-number">1.1</span> Document Control</a></li>
<li><a href="#introduction" id="toc-introduction"><span
class="toc-section-number">1.2</span> 1. Introduction</a></li>
<li><a href="#end-to-end-pick-place-sequence"
id="toc-end-to-end-pick-place-sequence"><span
class="toc-section-number">1.3</span> 2. End-to-End Pick-Place
Sequence</a>
<ul>
<li><a href="#complete-workflow-nominal-path"
id="toc-complete-workflow-nominal-path"><span
class="toc-section-number">1.3.1</span> 2.1 Complete Workflow (Nominal
Path)</a></li>
</ul></li>
<li><a href="#vision-pipeline-sequence"
id="toc-vision-pipeline-sequence"><span
class="toc-section-number">1.4</span> 3. Vision Pipeline Sequence</a>
<ul>
<li><a href="#object-detection-pose-estimation"
id="toc-object-detection-pose-estimation"><span
class="toc-section-number">1.4.1</span> 3.1 Object Detection &amp; Pose
Estimation</a></li>
</ul></li>
<li><a href="#grasp-planning-sequence"
id="toc-grasp-planning-sequence"><span
class="toc-section-number">1.5</span> 4. Grasp Planning Sequence</a>
<ul>
<li><a href="#grasp-synthesis-collision-checking"
id="toc-grasp-synthesis-collision-checking"><span
class="toc-section-number">1.5.1</span> 4.1 Grasp Synthesis &amp;
Collision Checking</a></li>
</ul></li>
<li><a href="#motion-planning-sequence-moveit2"
id="toc-motion-planning-sequence-moveit2"><span
class="toc-section-number">1.6</span> 5. Motion Planning Sequence
(MoveIt2)</a>
<ul>
<li><a href="#path-planning-with-collision-checking"
id="toc-path-planning-with-collision-checking"><span
class="toc-section-number">1.6.1</span> 5.1 Path Planning with Collision
Checking</a></li>
</ul></li>
<li><a href="#trajectory-execution-sequence"
id="toc-trajectory-execution-sequence"><span
class="toc-section-number">1.7</span> 6. Trajectory Execution
Sequence</a>
<ul>
<li><a href="#ros2_control-execution-loop"
id="toc-ros2_control-execution-loop"><span
class="toc-section-number">1.7.1</span> 6.1 ros2_control Execution
Loop</a></li>
</ul></li>
<li><a href="#error-recovery-sequence"
id="toc-error-recovery-sequence"><span
class="toc-section-number">1.8</span> 7. Error Recovery Sequence</a>
<ul>
<li><a href="#grasp-failure-retry" id="toc-grasp-failure-retry"><span
class="toc-section-number">1.8.1</span> 7.1 Grasp Failure â†’
Retry</a></li>
</ul></li>
<li><a href="#calibration-sequence" id="toc-calibration-sequence"><span
class="toc-section-number">1.9</span> 8. Calibration Sequence</a>
<ul>
<li><a href="#hand-eye-calibration" id="toc-hand-eye-calibration"><span
class="toc-section-number">1.9.1</span> 8.1 Hand-Eye
Calibration</a></li>
</ul></li>
<li><a href="#system-startup-sequence"
id="toc-system-startup-sequence"><span
class="toc-section-number">1.10</span> 9. System Startup Sequence</a>
<ul>
<li><a href="#boot-initialization" id="toc-boot-initialization"><span
class="toc-section-number">1.10.1</span> 9.1 Boot &amp;
Initialization</a></li>
</ul></li>
<li><a href="#shutdown-sequence" id="toc-shutdown-sequence"><span
class="toc-section-number">1.11</span> 10. Shutdown Sequence</a>
<ul>
<li><a href="#graceful-shutdown" id="toc-graceful-shutdown"><span
class="toc-section-number">1.11.1</span> 10.1 Graceful Shutdown</a></li>
</ul></li>
<li><a href="#summary" id="toc-summary"><span
class="toc-section-number">1.12</span> Summary</a></li>
</ul></li>
</ul>
</nav>
<h1 data-number="1"
id="sequence-diagrams---vision-based-pick-and-place-system"><span
class="header-section-number">1</span> Sequence Diagrams - Vision-Based
Pick and Place System</h1>
<h2 data-number="1.1" id="document-control"><span
class="header-section-number">1.1</span> Document Control</h2>
<table>
<thead>
<tr class="header">
<th><strong>Item</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Document Title</strong></td>
<td>Sequence Diagrams</td>
</tr>
<tr class="even">
<td><strong>Version</strong></td>
<td>1.0</td>
</tr>
<tr class="odd">
<td><strong>Date</strong></td>
<td>2025-10-18</td>
</tr>
<tr class="even">
<td><strong>Status</strong></td>
<td>Draft</td>
</tr>
<tr class="odd">
<td><strong>Author(s)</strong></td>
<td>System Architect</td>
</tr>
</tbody>
</table>
<hr />
<h2 data-number="1.2" id="introduction"><span
class="header-section-number">1.2</span> 1. Introduction</h2>
<p>This document provides sequence diagrams showing time-ordered
interactions between system components. All diagrams use ASCII art and
can be rendered with Mermaid or PlantUML.</p>
<hr />
<h2 data-number="1.3" id="end-to-end-pick-place-sequence"><span
class="header-section-number">1.3</span> 2. End-to-End Pick-Place
Sequence</h2>
<h3 data-number="1.3.1" id="complete-workflow-nominal-path"><span
class="header-section-number">1.3.1</span> 2.1 Complete Workflow
(Nominal Path)</h3>
<pre><code>User    Task         Vision      Grasp       MoveIt2     ros2_control   Robot    Gripper
 â”‚      Orchestrator  Pipeline   Planner                 Manager        Arm
 â”‚          â”‚            â”‚          â”‚            â”‚            â”‚           â”‚         â”‚
 â”œâ”€Startâ”€â”€â”€â–¶â”‚            â”‚          â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚          â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚â”€ScanReqâ”€â”€â”€â–¶â”‚          â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚          â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚â”€Captureâ”€â”€â–¶Camera      â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚          â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚â—€â”€Imageâ”€â”€â”€â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚          â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚â”€RunYOLOâ”€â”€â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚          â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚â”€EstPoseâ”€â”€â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚          â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚â—€â”€ObjPosesâ”€â”€â”‚          â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚          â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚â”€GraspReqâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚          (pose,cloud)  â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚â”€Sampleâ”€â”€â”€â”€â”€â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚â”€CheckCollâ”€â”€â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚â”€RankGraspsâ”€â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚â—€â”€GraspPoseâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚â”€PlanPickReqâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚        (target_pose)   â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚â”€SolveIKâ”€â”€â”€â”€â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚â”€PlanPathâ”€â”€â”€â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚      (RRT*)â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚â”€GenTrajâ”€â”€â”€â”€â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚â—€â”€Trajectoryâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚â”€ExecPickReqâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚       (trajectory)     â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚â”€MoveToPreâ”€â–¶         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚â”€MoveToGrspâ–¶         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚â”€CloseGripperâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚â—€â”€GraspForceâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
 â”‚          â”‚         (F/T sensor: 20N)            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚â”€CheckGraspâ”€â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”œâ”€Successâ”€â”€â”€â”€â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚â”€PlanPlaceReqâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚â”€PlanPathâ”€â”€â”€â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚â—€â”€Trajectoryâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚â”€ExecPlaceReqâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚â”€MoveToTargetâ–¶       â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚â”€OpenGripperâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚â”€Retractâ”€â”€â”€â–¶         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚â”€ReturnHomeâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚â”€MoveHomeâ”€â”€â–¶         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚â—€â”€Completeâ”€â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚
 â”‚          â”‚            â”‚            â”‚            â”‚            â”‚           â”‚         â”‚</code></pre>
<p><strong>Timing:</strong> - Total cycle time: ~2 seconds - Vision
(Scan â†’ ObjPoses): 150ms - Grasp planning: 200ms - Motion planning
(pick): 300ms - Execution (pick): 800ms - Motion planning (place): 250ms
- Execution (place): 300ms</p>
<hr />
<h2 data-number="1.4" id="vision-pipeline-sequence"><span
class="header-section-number">1.4</span> 3. Vision Pipeline
Sequence</h2>
<h3 data-number="1.4.1" id="object-detection-pose-estimation"><span
class="header-section-number">1.4.1</span> 3.1 Object Detection &amp;
Pose Estimation</h3>
<pre><code>Task         Camera      Image       Object      Pose         TF2
Orchestrator Driver      Processor   Detector    Estimator
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚â”€ScanRequestâ”€â–¶â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚â”€Triggerâ”€â”€â”€â–¶â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚â—€â”€RGB+Depthâ”€â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚â”€PublishRGBâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶           â”‚          â”‚
 â”‚              â”‚  (topic)   â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚â”€PublishDepthâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚           â”‚          â”‚
 â”‚              â”‚  (topic)   â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚â”€Preprocessâ”‚          â”‚
 â”‚              â”‚            â”‚           â”‚ (resize)  â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚â”€RunYOLOâ”€â”€â”€â”‚          â”‚
 â”‚              â”‚            â”‚      (TensorRT)       â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚â”€NMSâ”€â”€â”€â”€â”€â”€â”€â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚â”€Filterâ”€â”€â”€â”€â”‚          â”‚
 â”‚              â”‚            â”‚       (conf&gt;0.7)      â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚â”€Publishâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶Task
 â”‚              â”‚            â”‚           â”‚Detections â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
 â”‚              â”‚            â”‚           â”‚      (for each det)   â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚â”€ExtractROI
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚â”€Deprojectâ”€â”‚
 â”‚              â”‚            â”‚           â”‚      (depthâ†’3D)      â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚â”€EstPoseâ”€â”€â”€â”‚
 â”‚              â”‚            â”‚           â”‚         (PnP/ICP)    â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚â”€LookupTFâ”€â”€â–¶â”‚
 â”‚              â”‚            â”‚           â”‚   (cameraâ†’base)      â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚â—€â”€Transformâ”‚
 â”‚              â”‚            â”‚           â”‚           â”‚          â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚â”€Publishâ”€â”€â”€â–¶Task
 â”‚              â”‚            â”‚           â”‚          Poses       â”‚
 â”‚              â”‚            â”‚           â”‚          (base frame)â”‚
 â”‚â—€â”€ObjPosesâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</code></pre>
<hr />
<h2 data-number="1.5" id="grasp-planning-sequence"><span
class="header-section-number">1.5</span> 4. Grasp Planning Sequence</h2>
<h3 data-number="1.5.1" id="grasp-synthesis-collision-checking"><span
class="header-section-number">1.5.1</span> 4.1 Grasp Synthesis &amp;
Collision Checking</h3>
<pre><code>Task         Grasp       Grasp        Collision    Grasp
Orchestrator Planner     Sampler      Checker      Ranker
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚â”€GraspRequestâ”€â–¶â”‚            â”‚             â”‚           â”‚
 â”‚  (pose,cloud)â”‚            â”‚             â”‚           â”‚
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚              â”‚â”€Sampleâ”€â”€â”€â”€â–¶â”‚             â”‚           â”‚
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚              â”‚            â”‚â”€GenCandidates           â”‚
 â”‚              â”‚            â”‚  (N=50)     â”‚           â”‚
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚              â”‚â—€â”€Graspsâ”€â”€â”€â”€â”‚             â”‚           â”‚
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚              â”‚â”€ForEachâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚           â”‚
 â”‚              â”‚   Grasp    â”‚             â”‚           â”‚
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚              â”‚            â”‚             â”‚â”€CheckGripper
 â”‚              â”‚            â”‚             â”‚ -Object   â”‚
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚              â”‚            â”‚             â”‚â”€CheckGripper
 â”‚              â”‚            â”‚             â”‚ -Scene    â”‚
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚              â”‚â—€â”€CollFreeâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚           â”‚
 â”‚              â”‚   (boolean)â”‚             â”‚           â”‚
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚              â”‚â”€IfCollFreeâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚              â”‚            â”‚             â”‚           â”‚â”€CompQuality
 â”‚              â”‚            â”‚             â”‚      (force closure)
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚              â”‚â—€â”€Qualityâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚              â”‚â”€AddToValidâ”€â”‚             â”‚           â”‚
 â”‚              â”‚  List      â”‚             â”‚           â”‚
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚              â”‚â”€EndLoopâ”€â”€â”€â”€â”‚             â”‚           â”‚
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚              â”‚â”€Sortâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
 â”‚              â”‚  ByQuality â”‚             â”‚           â”‚
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚              â”‚â—€â”€RankedListâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚              â”‚â”€SelectTopâ”€â”€â”‚             â”‚           â”‚
 â”‚              â”‚            â”‚             â”‚           â”‚
 â”‚â—€â”€GraspPoseâ”€â”€â”€â”‚            â”‚             â”‚           â”‚
 â”‚   +Quality   â”‚            â”‚             â”‚           â”‚</code></pre>
<hr />
<h2 data-number="1.6" id="motion-planning-sequence-moveit2"><span
class="header-section-number">1.6</span> 5. Motion Planning Sequence
(MoveIt2)</h2>
<h3 data-number="1.6.1" id="path-planning-with-collision-checking"><span
class="header-section-number">1.6.1</span> 5.1 Path Planning with
Collision Checking</h3>
<pre><code>Task         MoveIt      Planning    IK          OMPL        Trajectory
Orchestrator MoveGroup   Scene       Solver      Planner     Generator
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚â”€PlanRequestâ”€â”€â–¶â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚ (target_pose)â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚â”€UpdateSceneâ”€â–¶           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚â”€AddObstacles          â”‚            â”‚
 â”‚              â”‚       (point cloud)    â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚â—€â”€SceneReadyâ”€           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚â”€SolveIKâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚â”€ComputeIKâ”€â”‚            â”‚
 â”‚              â”‚            â”‚      (KDL/TRAC-IK)    â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚â—€â”€JointAnglesâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚â”€ValidateGoal           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚â”€PlanPathâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶            â”‚
 â”‚              â”‚            â”‚      (start, goal)    â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚â”€RunRRT*â”€â”€â”€â”€â”‚
 â”‚              â”‚            â”‚           â”‚     (5 sec timeout)    â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚â”€CheckCollâ”€â”€â–¶Scene
 â”‚              â”‚            â”‚           â”‚   (repeated)           â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚â—€â”€CollFreeâ”€â”€â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚â—€â”€Pathâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚            â”‚
 â”‚              â”‚            â”‚      (joint configs)  â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚â”€GenTrajectoryâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚â”€TimeParam
 â”‚              â”‚            â”‚           â”‚           â”‚       (parabolic)
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚â”€ApplyLimits
 â”‚              â”‚            â”‚           â”‚     (vel, accel)       â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚â—€â”€Trajectoryâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚â—€â”€Trajectoryâ”€â”€â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚   (ready)    â”‚            â”‚           â”‚           â”‚            â”‚</code></pre>
<hr />
<h2 data-number="1.7" id="trajectory-execution-sequence"><span
class="header-section-number">1.7</span> 6. Trajectory Execution
Sequence</h2>
<h3 data-number="1.7.1" id="ros2_control-execution-loop"><span
class="header-section-number">1.7.1</span> 6.1 ros2_control Execution
Loop</h3>
<pre><code>MoveIt      Controller   Trajectory  PID         Hardware    Motor
MoveGroup   Manager      Follower    Controller  Interface   Driver
 â”‚              â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚â”€ExecActionâ”€â”€â–¶â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚ (trajectory) â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚              â”‚â”€LoadTrajâ”€â”€â”€â–¶           â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚â”€Startâ”€â”€â”€â”€â”€â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚  Loop     â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚  @1kHz    â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚â”€Interpolate           â”‚           â”‚
 â”‚              â”‚            â”‚ Setpoint  â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚  (t=now)  â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚â”€SendSetpointâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶           â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚           â”‚â”€CompPIDâ”€â”€â”€â”‚           â”‚
 â”‚              â”‚            â”‚     (error = sp-fb)   â”‚           â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚           â”‚â”€AddFFâ”€â”€â”€â”€â”€â”‚           â”‚
 â”‚              â”‚            â”‚      (gravity comp)   â”‚           â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚           â”‚â”€Outputâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
 â”‚              â”‚            â”‚         (torque cmd)  â”‚           â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚â”€ReadEncâ”€â”€â”€â–¶â”‚
 â”‚              â”‚            â”‚           â”‚     (position)        â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚           â”‚â—€â”€Feedbackâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚â—€â”€JointStatesâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚           â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚              â”‚â—€â”€Feedbackâ”€â”€â”‚           â”‚           â”‚           â”‚
 â”‚   (progress) â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚â”€CheckDoneâ”€â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚â”€IfDoneâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶           â”‚
 â”‚              â”‚            â”‚  Stop     â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚  Loop     â”‚           â”‚           â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚â—€â”€Resultâ”€â”€â”€â”€â”€â”€â”‚            â”‚           â”‚           â”‚           â”‚
 â”‚  (success)   â”‚            â”‚           â”‚           â”‚           â”‚</code></pre>
<p><strong>Loop Timing:</strong> - Control frequency: 1000 Hz (1ms
period) - Setpoint interpolation: &lt;50Î¼s - PID computation: &lt;100Î¼s
- EtherCAT communication: &lt;200Î¼s - Total loop time: &lt;1ms (with
margin for jitter)</p>
<hr />
<h2 data-number="1.8" id="error-recovery-sequence"><span
class="header-section-number">1.8</span> 7. Error Recovery Sequence</h2>
<h3 data-number="1.8.1" id="grasp-failure-retry"><span
class="header-section-number">1.8.1</span> 7.1 Grasp Failure â†’
Retry</h3>
<pre><code>Task         F/T         Error       Grasp       MoveIt2     ros2_control
Orchestrator Sensor      Detector    Planner                 Manager
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚â”€ExecPickâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚â”€â”€MoveToPreâ”€â”€â–¶Robot
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚â”€â”€MoveToGrspâ”€â–¶Robot
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚â”€CloseGripperâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶Gripper
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚â—€â”€ForceReadingâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
 â”‚              â”‚   (5N, low!)          â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚â”€DetectDropâ”€â–¶           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚â”€RaiseFault            â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚â—€â”€ErrorEventâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚           â”‚           â”‚            â”‚
 â”‚  (GRASP_FAIL)            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚â”€LogErrorâ”€â”€â”€â”€â”€â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚â”€CheckRetryâ”€â”€â”€â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚  Count       â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚â”€IfRetry&lt;Maxâ”€â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚â”€Retractâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚â”€â”€MoveBackâ”€â”€â”€â–¶Robot
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚â”€ReplanGraspâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚           â”‚            â”‚
 â”‚  (increase   â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚   force)     â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚â”€AdjustForce           â”‚
 â”‚              â”‚            â”‚           â”‚  (50%â†’100%)           â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚â—€â”€NewGraspâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚â”€RetryPickâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚â”€â”€Executeâ”€â”€â”€â”€â–¶Robot
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚â”€CloseGripperâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶Gripper
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚â—€â”€ForceReadingâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
 â”‚              â”‚   (20N, OK!)          â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚â—€â”€Successâ”€â”€â”€â”€â”€â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚              â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚â”€Continueâ”€â”€â”€â”€â”€â”‚            â”‚           â”‚           â”‚            â”‚
 â”‚  (place)     â”‚            â”‚           â”‚           â”‚            â”‚</code></pre>
<hr />
<h2 data-number="1.9" id="calibration-sequence"><span
class="header-section-number">1.9</span> 8. Calibration Sequence</h2>
<h3 data-number="1.9.1" id="hand-eye-calibration"><span
class="header-section-number">1.9.1</span> 8.1 Hand-Eye Calibration</h3>
<pre><code>Calib       Robot       Camera      Detection   Calibration
Wizard      Controller  Driver      Node        Solver
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€Startâ”€â”€â”€â”€â”€â”€â”€â”€â”‚           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€MoveToPos1â”€â”€â–¶           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚              â”‚â”€Executeâ”€â”€â”€â–¶           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â—€â”€AtPositionâ”€â”€â”‚           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€CaptureImgâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚â”€Triggerâ”€â”€â”€â–¶             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚â—€â”€Imageâ”€â”€â”€â”€â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶             â”‚
 â”‚              â”‚           â”‚ Detect    â”‚             â”‚
 â”‚              â”‚           â”‚ Checkerboard            â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â—€â”€Cornersâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€ReadRobotPoseâ–¶           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â—€â”€TcpPoseâ”€â”€â”€â”€â”€â”‚           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€StoreDataâ”€â”€â”€â”€â”‚           â”‚           â”‚             â”‚
 â”‚ (corners,    â”‚           â”‚           â”‚             â”‚
 â”‚  robot_pose) â”‚           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€RepeatForâ”€â”€â”€â”€â”‚           â”‚           â”‚             â”‚
 â”‚  Pos2-5      â”‚           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚ (loop 4 more times)      â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€AllDataCollected         â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€SolveCalibâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
 â”‚              â”‚           â”‚      (AX=XB)            â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚â”€ComputeTF
 â”‚              â”‚           â”‚           â”‚       (cameraâ†’base)
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â—€â”€Transformationâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
 â”‚   Matrix     â”‚           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€Validateâ”€â”€â”€â”€â”€â”‚           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€PlaceObjectâ”€â”€â”‚           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€DetectObjectâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â—€â”€Pos(camera)â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€TransformToâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
 â”‚  BaseFrame   â”‚           â”‚   (using TF)            â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â—€â”€Pos(base)â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€MeasureActualâ–¶           â”‚           â”‚             â”‚
 â”‚  (CMM/ruler) â”‚           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â—€â”€ActualPosâ”€â”€â”€â”‚           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€CompErrorâ”€â”€â”€â”€â”‚           â”‚           â”‚             â”‚
 â”‚ (predicted-  â”‚           â”‚           â”‚             â”‚
 â”‚  actual)     â”‚           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€IfError&lt;5mmâ”€â”‚           â”‚           â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â”€SaveCalibâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
 â”‚              â”‚      (to YAML file)   â”‚             â”‚
 â”‚              â”‚           â”‚           â”‚             â”‚
 â”‚â—€â”€Successâ”€â”€â”€â”€â”€â”‚           â”‚           â”‚             â”‚</code></pre>
<hr />
<h2 data-number="1.10" id="system-startup-sequence"><span
class="header-section-number">1.10</span> 9. System Startup
Sequence</h2>
<h3 data-number="1.10.1" id="boot-initialization"><span
class="header-section-number">1.10.1</span> 9.1 Boot &amp;
Initialization</h3>
<pre><code>User    Init        ROS2        Vision      MoveIt2     ros2_control  Robot
        Script      Daemon      Nodes       Nodes       Manager       Hardware
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚â”€PowerOnâ”€â–¶           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚â”€StartROS2 â–¶            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚â”€LaunchCoreâ”€â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚â—€â”€CoreReadyâ”€â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚â”€LaunchVisionâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚â”€InitCameraâ”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚â—€â”€CamReadyâ”€â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚â”€LoadModelâ”€â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚        (YOLOv8)        â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚â—€â”€ModelReady           â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚â”€LaunchMoveItâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚â”€LoadURDFâ”€â”€â”€â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚â”€InitPlanningScene       â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚â—€â”€Readyâ”€â”€â”€â”€â”€â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚â”€LaunchControlâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚â”€InitHWâ”€â”€â”€â”€â”€â–¶
 â”‚         â”‚           â”‚            â”‚           â”‚      (EtherCAT)         â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚â—€â”€HwReadyâ”€â”€â”€â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚â”€LoadControllers
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚â—€â”€CtrlReadyâ”€â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚â”€HomeRobotâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚â”€MoveHomeâ”€â”€â”€â–¶
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚â—€â”€AtHomeâ”€â”€â”€â”€â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚â—€â”€SystemReadyâ”€â”€â”€â”€â”€â”€â”€â”€â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚         â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚â”€Displayâ”€â”‚           â”‚            â”‚           â”‚            â”‚            â”‚
 â”‚ &quot;READY&quot; â”‚           â”‚           â”‚           â”‚            â”‚            â”‚</code></pre>
<p><strong>Startup Time:</strong> ~45 seconds total - ROS2 daemon: 5s -
Vision nodes: 15s (model loading) - MoveIt2: 10s (URDF, planning scene)
- ros2_control: 10s (EtherCAT init, homing) - Final checks: 5s</p>
<hr />
<h2 data-number="1.11" id="shutdown-sequence"><span
class="header-section-number">1.11</span> 10. Shutdown Sequence</h2>
<h3 data-number="1.11.1" id="graceful-shutdown"><span
class="header-section-number">1.11.1</span> 10.1 Graceful Shutdown</h3>
<pre><code>User    Task         ros2_control  MoveIt2    Vision      ROS2
        Orchestrator Manager        Nodes      Nodes       Daemon
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚â”€Shutdownâ”€â–¶            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚â”€StopTasksâ”€â”€â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚â”€MoveHomeâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶            â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚            â”‚â”€Executeâ”€â”€â”€â”€â–¶          â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚â—€â”€AtHomeâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚          â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚â”€DisableMotorsâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶            â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚            â”‚â”€Deactivateâ”€â–¶          â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚â—€â”€MotorsOffâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚          â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚â”€StopVisionâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚â”€UnloadModel
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚â”€CloseCamera
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚â—€â”€VisionStoppedâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚â”€StopMoveItâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚â—€â”€MoveItStoppedâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚â”€StopControlâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶            â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚            â”‚â”€UnloadCtrlâ”€â”‚          â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚            â”‚â”€CloseHWâ”€â”€â”€â”€â–¶          â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚â—€â”€ControlStoppedâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚          â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚â”€ShutdownROSâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚â”€KillNodes
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚â—€â”€Shutdownâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚            â”‚          â”‚           â”‚
 â”‚ Complete â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚          â”‚            â”‚            â”‚          â”‚           â”‚
 â”‚â”€PowerOffâ”€â”‚            â”‚            â”‚          â”‚           â”‚</code></pre>
<hr />
<h2 data-number="1.12" id="summary"><span
class="header-section-number">1.12</span> Summary</h2>
<p>This document provides <strong>10 comprehensive sequence
diagrams</strong> covering:</p>
<ol type="1">
<li><strong>End-to-End Pick-Place</strong> - Complete workflow with all
subsystems</li>
<li><strong>Vision Pipeline</strong> - Object detection and pose
estimation</li>
<li><strong>Grasp Planning</strong> - Synthesis and collision
checking</li>
<li><strong>Motion Planning</strong> - MoveIt2 path planning</li>
<li><strong>Trajectory Execution</strong> - ros2_control real-time
loop</li>
<li><strong>Error Recovery</strong> - Grasp failure retry logic</li>
<li><strong>Calibration</strong> - Hand-eye calibration procedure</li>
<li><strong>System Startup</strong> - Boot and initialization</li>
<li><strong>System Shutdown</strong> - Graceful shutdown</li>
</ol>
<p><strong>Key Insights:</strong> - Vision pipeline: 150ms
(cameraâ†’poses) - Grasp planning: 200ms (poseâ†’grasp) - Motion planning:
300-500ms (IKâ†’trajectory) - Control loop: 1ms period @ 1kHz - Startup
time: ~45 seconds - Total cycle time: ~2 seconds (scanâ†’place)</p>
<hr />
<p><strong>Document Status:</strong> âœ… Complete <strong>Last
Updated:</strong> 2025-10-18 <strong>Format:</strong> ASCII sequence
diagrams (convertible to Mermaid) <strong>Review Status:</strong>
Pending Technical Review</p>
</div></body>
</html>
